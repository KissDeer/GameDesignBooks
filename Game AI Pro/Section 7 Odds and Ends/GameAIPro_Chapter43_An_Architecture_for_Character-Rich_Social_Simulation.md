# 七杠一、丰富角色社交模拟架构



作者：Michael Mateas 和 Josh McCoy

## 43.1 引言



在创建参与持续社交活动的非玩家角色（NPC）方面，相较于创建仅从事自主活动或围绕战斗组织的小群体行为（如小队行为）的 NPC，进展较为缓慢。社交活动通常没有明确的功能性目标，而是涉及社交参与者对社交状态的回应、展示和改变。社交行为在很大程度上依赖于先前社交行为的历史。复杂的社交行为通常最好通过对话来完成，利用自然语言的丰富性来表达情感、关系状态和历史。最后，社交行为嵌入在丰富的社交背景中 —— 行为往往会对多个社交参与者产生影响。强调以实现功能性目标为重点的个体决策、专注于即时行动选择的 NPC 架构很难满足社交行为的这些特征。



本章介绍了 “得体社交”（Comme il Faut，CiF）社交模拟架构。CiF 被用于创建《舞会周》（Prom Week），这是一款社交解谜和叙事游戏，在 2012 年游戏开发者大会（GDC）的独立游戏节上获得技术卓越奖提名，并获得 2012 年 IndieCade 提名。“Comme il Faut” 在法语中大致意为 “理应如此”，该架构满足上述要求。在 CiF 中，多角色社交互动的概念是一种首要的人工智能构建。角色利用社交状态的许多细节，包括先前互动的历史，来决定如何参与这些多角色社交交流。系统会根据特定角色在特定社交情境中的详细个性和历史，自动将这些交流中的对话重新定位到具体角色。该架构的目标是使一群角色能够进行丰富的社交互动，说出通常与手工编写的对话树相关联的具体对话，同时利用通常与模拟游戏相关联的一定程度的涌现式社交模拟。



本章其余部分首先介绍已发布的实验性游戏《舞会周》，该游戏使用 CiF 支持一种互动叙事形式，游戏玩法围绕解决社交谜题以实现故事目标展开。本章的主要内容描述了 CiF 的主要架构元素。最后，本章描述了类似 CiF 架构可以支持的不同交互风格，并介绍了相关工作。本章的目标是提供足够的细节，以便读者在自己的工作中借鉴 CiF 架构的元素，同时又不会让读者淹没在实现细节中。

## 43.2 CiF 与《舞会周》



虽然 CiF 的早期版本是作为一个独立的社交模拟系统开发的 [McCoy 和 Mateas 09]，但随着《舞会周》的开发，其架构和创作方法有了很大的发展 [McCoy 等人 10a, McCoy 等人 10b]。在本章的其余部分，所有不同类型的 CiF 创作（知识表示）示例都将来自《舞会周》。当然，如果在不同的游戏中使用类似 CiF 的架构，将会创作不同的内容，但在创建一个完整、可玩的体验的背景下创建 CiF 架构，迫使我们根据创作和开发的全部复杂性对架构进行扩展。



开发 CiF 的最初灵感来自于在创建互动戏剧《门面》（Façade）期间遇到的创作限制 [Mateas 和 Stern 02; Mateas 和 Stern 03]。《门面》是一部互动戏剧，玩家从第一人称视角与一对婚姻出现问题的夫妇进行 20 分钟的简短互动。《门面》中的角色行为围绕戏剧性节拍组织，即大约 1 分钟的互动，角色在其中共同传达故事的某些方面或他们的个性。在《门面》中，这些行为集群是为表达特定内容的特定角色编写的 [Mateas 和 Stern 07]。行为中的变化隐含地编码在行为中，并且在角色之间不可重用。我们开发 CiF 的初衷是将多角色交流概括为可重用的单元，明确支持特定角色的表现变化。动态重定向动画允许动画创作工作在多个角色之间重用。同样，我们希望实现动态定位的 NPC 对话，即更一般地创作多角色对话表现，然后在特定情况下针对特定角色进行定位。从这个最初的目标出发，我们的最终架构提供了以下主要功能：



- 多角色社交交流与任何特定角色分开明确表示。给定一组具有特征和社交状态声明表示的角色，社交交流针对特定角色重新定位。
- 角色基于软决策（不是布尔标志或严格的前提条件）决定他们想做什么以及与谁一起做，软决策可以考虑数百个因素。
- 社交互动不仅会导致社交状态的单一变化，还会在多个角色中产生级联后果。
- 先前社交互动的表现细节和结果
- 存储在情景记忆中，并在社交交流表现期间（社交交流对话可以参考过去的表现）以及帮助确定角色想要参与哪些社交交流时使用。
- 这些特性共同为模拟一个社交世界奠定了基础，在这个世界中，角色沉浸在不断演变的社交状态海洋中。在简要介绍《舞会周》之后，我们将详细介绍架构的这些不同元素。



### 43.2.1 《舞会周》



在《舞会周》中，玩家在舞会前的一周内控制 18 名高中生的生活。游戏玩法包括玩家选择角色对，并选择第一个角色与第二个角色发起的社交交流。给定选定的角色对，CiF 确定第一个角色最想发起的行动，并在菜单中呈现给玩家，以及第二个角色对选定互动的反应。在图 43.1 中，玩家正在从 CiF 最想在两个选定角色之间执行的五个社交交流中进行选择，当前突出显示的是 “搭讪”（Pick-Up Line），这是一个旨在发起约会关系的交流。一旦选择了社交交流，CiF 就会决定两个角色将如何执行该交流。图 43.2 显示了正在进行的 “残忍分手”（Brutal Break-Up）社交交流的表现，这是一个旨在终止约会关系的交流。玩家试图实现故事目标，例如让一个角色与特定的其他角色约会、结交一定数量的朋友或让一定数量的好事或坏事发生在他们身上。图 43.3 显示了《舞会周》其中一个场景的故事目标。由于 CiF 进行的底层社交建模，故事目标有多个涌现的、非预设的解决方案，玩家完成的不同故事目标组合会在舞会上开启不同的结局。通过这种方式，《舞会周》将叙事和角色探索与基于模拟的游戏玩法相结合。



为了帮助玩家掌握底层社交系统，《舞会周》的界面允许玩家探索角色发起社交交流的动机、他们对社交交流做出特定反应的原因、社交交流产生特定效果的原因以及当前的社交状态。图 43.4 显示了玩家可以用来探索社交交流为何以某种方式发生的界面。这些解释是通过分析影响交流的最重要规则生成的。图 43.5 显示了玩家可以用来探索当前社交状态的界面，以指导角色和社交交流的战略选择。以可用的方式向玩家展示适量的复杂模拟状态是《舞会周》的主要设计挑战之一。



当玩家成功实现社交交流时，他们会获得社交影响力点数。社交影响力点数可以用来提前查看社交交流的结果、影响社交交流的因素和 / 或覆盖结果。社交影响力点数的战略管理成为游戏玩法的另一个元素。

## 43.3 CiF 架构



CiF 的主要知识表示元素是社交交流，它是一种（主要是对话）交互模式的集合，其确切的表现和社交结果根据所涉及角色的特定个性属性和当前社交状态而有所不同。社交交流的概念受到欧文・戈夫曼（Erving Goffman）在社会学中对社会互动的戏剧分析工作的启发 [Goffman 59]。戈夫曼将日常生活中的社会互动视为旨在表达个人性格特征或改变社交状态的戏剧性表演。他使用戏剧隐喻来分析人们如何邀请他人在自己的表演中扮演角色、将空间和物体组织成表演的 “舞台” 和 “道具” 等等。在 CiF 中，社交交流由围绕其旨在改变或表达的社交状态元素组织的表演分类组成。在深入探讨社交交流的细节之前，有必要首先了解角色和社交状态是如何表示的。

### 43.3.1 角色



角色由表 43.1 中描述的元素组成。



由于重点放在社交交流上，每个角色的表示相对简单，由少量声明性信息组成（即向底层人工智能系统指定角色属性的信息，但由系统决定如何以及何时表达这些属性）。使一个角色丰富和独特的是他们在社交世界中的处境和他们的历史，而不是一堆特定于角色的人工智能行为。



特质和状态描述了角色的个性和角色状态。特质是对社交交流有重大影响的角色的永久性属性。对于角色 x，示例包括特质（聪明，x）、特质（固执，x）、特质（爱出风头，x）和特质（有魅力，x）。特质只有在前提条件和影响规则中被引用以确定角色想要发起哪些社交交流以及在社交交流的不同实例中进行选择时才有意义。



状态是由社交交流产生的临时的、可选方向性的、二元的社会效果。状态捕捉代理情绪的短暂状态（例如，状态（愉快，x））、代理之间的强烈情绪波动（例如，状态（暗恋，x，y））和社会状态（例如，状态（受欢迎，x））。它们有助于捕捉短暂但有力的社会情况和角色状态。当一个状态由社交交流发布时，它包括一个持续时间规范，说明该状态在超时之前持续多长时间。



前瞻性记忆是角色与特定角色进行特定社交交流的数字意愿（欲望）向量。这些意愿由发起者影响规则计算，如下面 “社交交流” 部分所述。



特定角色短语是在社交交流中填充到对话模板中的内容。这是将一般社交交流对话重新定位到特定角色的一种方式。在《舞会周》中定义的特定角色短语包括 % 问候语 %（开场问候短语）、% 震惊 %（震惊的表达）、% 积极形容词 %（积极形容词）、% 贬义词 %（对某人的恶语）和 % 甜心 %（爱称）。每当这些标签出现在社交交流对话中时，它们都会被相应的特定角色短语替换。一个角色定义应该为社交交流中使用的每个特定角色标签包含一个或多个短语。

### 43.3.2 社会状态



世界的社会状态由四种不同的表示形式捕捉：社交网络、关系、文化知识库和社会事实知识库。



社交网络是双向完全连接的网络，其中边值衡量角色之间的感情。《舞会周》有三个网络：浪漫网络，表示角色对彼此追求亲密关系的兴趣程度；友谊网络，表示角色彼此喜欢的程度；“酷” 网络，表示角色彼此尊重的程度。如果 x 对 y 的浪漫网络值为 80，但 y 对 x 只有 20，那么这些角色对他们的情况有不同的看法。社交网络值是角色对彼此的私人感情。仅仅因为两个角色对彼此有很高的友好感情并不意味着他们自动具有被公开认可的朋友社会状态。彼此有高友好感情的角色会强烈倾向于进行导致他们成为朋友的社交交流，但需要一个社交交流来将彼此的私人友好感情转化为公开认可的友谊（浪漫关系等情况类似）。



关系代表角色之间公开认可的社会关系。在《舞会周》中，三种关系是朋友、约会和敌人。与具有数值范围的社交网络值不同，关系是二元的：两个角色要么是朋友，要么不是；要么在约会，要么没有；要么是敌人，要么不是。社交网络和关系之间的区别使得能够表示极具戏剧性（且可悲地贴近生活）的状态。例如，给定三个角色 x、y 和 z，CiF 可以表示这样的状态：关系（约会，x，y）、网络（浪漫，x，y，20）、网络（浪漫，y，x，95）和网络（浪漫，x，z，80），这意味着 x 和 y 在约会，y 深深地爱着 x，而 x 已经不再爱 y 但对第三个角色 z 有好感。根据我们为《舞会周》开发的发起者和响应者影响规则（见下面 “社交交流” 部分），这种状态会使 x 更有意愿与 y 分手，但使 y 更有可能不接受分手（将其解释为玩笑或暂时的争吵），使 x 更有可能与 z 调情以增加浪漫并可能开始约会（这会使 y 生气并降低 y 对 x 的浪漫感情），使 y 更有可能与 x 发起积极的交流以增加浪漫，但也可能出于嫉妒或愤怒与 x 发起消极的交流（例如，如果 y 看到 x 与其他人调情）。关系表示还允许诸如既是朋友又是敌人（亦敌亦友）这样复杂的社会关系 —— 我们的目标是支持丰富和极具戏剧性的社会状态。



文化知识库（CKB）是进一步定义 CiF 驱动的代理所居住的世界的一种方式，为他们提供各种可以建立联系和争论的话题。创建 CKB 的设计意图是拥有一个在社会学上丰富的道具表示。在戏剧分析中，道具远不止是简单的物理对象，CiF 需要一种方法来理解物品在与故事世界的关系中的文化重要性。用于《舞会周》的 CKB 有许多项目，包括僵尸电影、电锯和网络漫画。每个代理都通过单向短语 “喜欢”、“不喜欢”、“想要” 和 “拥有” 与这些项目有一个或多个连接。冈特不喜欢摇头娃娃。奥斯瓦尔德喜欢网络漫画。菲比喜欢僵尸电影。此外，CKB 中的每个对象都可以与社会世界中普遍认可的属性相关联（例如，电锯很酷，躲避球很卑鄙）。这允许代理根据他们对世界上对象的个人意见相互作用。CKB 可以被查询以搜索角色对对象的态度模式。考虑以下示例查询：CKB 查询有四个部分（只需指定一个）：1）要查找的项目，item；2）第一个主观标签，例如（x，喜欢）；3）第二个主观标签，例如（y，不喜欢）；4）真实标签，例如 “蹩脚”。这个查询将匹配 x 喜欢、y 不喜欢且普遍被认为蹩脚的项目，这可能会增加 y 取笑 x 的意愿。



最后，社会事实知识库（SFKB）跟踪故事世界的社会历史，以便可以查询与社会相关的信息。SFKB 影响角色想要参与哪些社交交流以及他们如何回应，还影响社交交流的表现，在对话中会提及先前交流的细节。通常，游戏不会记录太多的交互历史并使用它来做出决策或在角色对话中提及它。通过将此历史作为架构的一部分，CiF 在社会模拟中提供了历史依赖性，这远远超出了使用诸如标志等临时技术所能实现的。



SFKB 为每个进行的社交交流和导致社会状态变化的每个触发规则存储一个条目。这个条目包括涉及的人员的详细信息，以及提到的文化知识库中的任何项目、一个可以用于将条目转换为用于表现的文本的自然语言生成模板，以及一个可以用于查询的抽象社交交流标签（例如，卑鄙、有趣、友好）。例如，如果爱德华与克洛伊发起 “欺负” 社交交流，进行一个具体的实例，其中 x 取笑 y 的 SAT 分数，以下条目将存储在 SFKB 中。



这个条目记录了社交交流的名称、涉及的角色、发起者和响应者影响规则计算的分数、时间戳（对于《舞会周》，这是离散的回合，但也可以是连续时间）、一个效果 ID，指示发生了哪种具体的 “欺负” 实例（在这种情况下，取笑 SAT 分数），以及一个标签，说明这是一个 “卑鄙” 的交流。SFKB 标签用于支持更抽象的查询。通常，查询不是针对特定的交流名称或实例，而是只关心一般的语气，查找过去一个角色对另一个角色做了卑鄙、友好或蹩脚等事情的事件。例如，如果克洛伊后来与爱德华发起 “背后中伤” 交流，“背后中伤” 的一个实例可以查询爱德华过去对克洛伊做过的卑鄙事情：[SFKBLabel (卑鄙，响应者，发起者，0) window (10)]，在这种情况下查看过去 10 个社交交流。匹配的条目然后转换为文本，导致表现为 “你还记得你取笑我的 SAT 分数的时候吗？”，发起者（在这种情况下是克洛伊）在揭露她的报复行为之前会这样说。通过这种方式，SFKB 支持历史的复合效应，角色越来越多地提及过去发生的事件，而过去的事件会影响决策。

### 43.3.3 社交交流



社交交流是 CiF 的核心。上一节描述的丰富的社会状态为角色发起社交交流提供了有趣的社会原因；这些交流然后改变社会状态。表 43.2 描述了社交交流的组成部分。



意图捕捉发起者发起社交交流的目的。这些目的涉及改变社会状态，例如增加另一个角色对发起者的友谊感情（社交网络值的变化）或发起或终止一种关系（如约会关系）。如果将社交交流视为复杂的计划操作符，意图就像操作符的后置条件。与传统计划操作符的不同之处在于，社交游戏可能会被响应者拒绝，这通常会导致几乎相反的状态变化。例如，对 y 有强烈浪漫感情的角色 x 可能会向 y 发起 “约会邀请” 游戏，意图与 y 开始约会关系。但仅仅因为 x 发起 “约会邀请”，并不意味着它会神奇地迫使 y 开始约会；y 可能对 x 生气，或者对 x 浪漫感情较低，或者因为 x 一直与 y 的好朋友进行多次积极的社交交流而嫉妒 x。有许多因素可能导致 y 拒绝 “约会邀请” 交流，拒绝的表现可能会导致 y 对 x 的浪漫感情更低。此外，社交交流可以通过触发规则产生级联效应。在这个例子中，x 可能会获得尴尬的状态，而甚至没有参与交流的第三方角色可能会获得同情 x 的状态。即使一个社交交流被接受并且期望的意图发生了，仍然经常会有额外的社会状态变化的多个级联效应，这是与传统计划操作符的进一步区别。对于《舞会周》，有 12 种不同的意图，6 种用于三个社交网络值，6 种用于三个关系：增加 / 减少友谊网络、增加 / 减少浪漫网络、增加 / 减少酷网络、发起 / 终止约会关系、发起 / 终止友谊关系和发起 / 终止敌人关系。



前提条件是根据当前环境中是否满足条件来决定社交交流是否适用的标准谓词条件。CiF 的目标之一是尽量减少这种硬决策，更多地依赖能够考虑许多因素且在意外状态下不易出错的软决策。因此，按照惯例，前提条件很少使用，只用于编码社交交流有意义的最低条件。例如，意图为终止约会关系的 “短信分手” 社交交流，只有在发起者和响应者当前正在约会时才有意义。《舞会周》中的许多社交交流没有前提条件（意味着它们总是可供考虑）。



发起者影响规则用于确定一个角色与其他角色发起社交交流的意愿（欲望）。响应者影响规则用于确定响应者是否接受或拒绝社交交流。每个社交交流有两个或三个角色：发起者 I、响应者 R 和一个可选的第三方角色，称为其他，O。影响规则在谓词参数中引用这些角色，CiF 根据正在为哪个角色计算意愿来适当地填充这些角色。每个社交交流都有特定的发起者和响应者规则，这些规则与大量称为微观理论的继承通用规则相结合，以确定意愿和接受 / 拒绝决策。这些规则的一般形式是：



我们首先考虑发起者影响规则的示例。对于《舞会周》中的 “惹恼” 社交交流，其意图是降低响应者对发起者的友谊感情，18 个影响规则中的两个是：



第一个规则说，如果发起者对响应者有很多浪漫感情（>66）并且发起者有不善表达的特质，将他们与响应者发起 “惹恼” 社交交流的倾向增加 3；不能很好表达自己的角色会倾向于通过打扰某人来表达对他们的浪漫吸引力。第二个规则，使用社会事实知识库查询，说如果响应者在过去 10 个社交交流中与发起者发起了交流，并且该交流被标记为酷，将他们发起 “惹恼” 社交交流的倾向减少 3；一个角色不太可能惹恼最近与他们进行过酷社交交流的人。



虽然每个社交交流都有少量特定规则，但大量共享规则存储在微观理论中。微观理论的目的是促进知识重用；支持只编写一次可能在许多社交交流中使用的规则。微观理论库构成了一个大型规则库，分为几十个微观理论。一个微观理论由一个定义和一组影响规则组成。微观理论的定义是一个条件，通常只由一个谓词组成。例如，关系（朋友，x，y）是 “朋友” 微观理论的定义。在计算意愿时，只有在当前上下文中其定义评估为真的微观理论才会被考虑。微观理论的规则集然后提供与该条件相关的社会 “常识” 的一般表示，例如，在 “朋友” 微观理论中，朋友比陌生人更有可能相处融洽，并且不太可能成为敌人。所以，对于 “惹恼” 社交交流的例子，如果发起者和响应者恰好是朋友，那么 “朋友” 微观理论的定义将得到满足，除了 “惹恼” 特定的发起者影响规则外，“朋友” 微观理论中的所有规则都将被考虑。在这种情况下，“朋友” 微观理论包含的规则将减少参与意图为降低友谊网络的行为的倾向，从而降低参与 “惹恼” 的意愿。当然，在形成意愿时可能会有多个微观理论处于活动状态。例如，如果除了是朋友之外，发起者还有自我毁灭的特质，那么 “自我毁灭” 微观理论也将处于活动状态。这个微观理论捕捉了自我毁灭角色的一般倾向，在 “惹恼” 的情况下，实际上会增加参与降低友谊意图的倾向。



为一个角色形成意愿涉及对每个社交交流的每个潜在响应者（和其他）的满足的发起者影响规则右侧的意愿进行求和。这个过程的结果是一个数字向量，对应于角色与每个角色进行每个社交交流的愿望。然后可以使用各种策略来决定采取什么行动，例如从排名前 N 的选项中进行加权随机选择以进行自主行动，或者像在《舞会周》中那样将排名前 N 的选项放在菜单中供玩家选择。通过结合规则缓存技术（如 Rete [Forgy 82]）并限制计算意愿的潜在响应者集合（例如，只计算附近的角色或场景中存在的角色），可以使意愿计算过程更加高效。



影响规则试图结合效用方法和布尔谓词表示的优点。效用方法有众所周知的优点，包括将不同的决策转换为单一的可比较基础（数字），并通过避免状态空间中未考虑到的角落来提高决策的稳健性，对于这些角落，二进制决策机制没有匹配 [Mark 09]。另一方面，谓词演算擅长表示复杂的状态联合，例如 “如果 x 对 y1 有强烈的浪漫感情，并且第三方 z 对 x 做了卑鄙的事情，接着 y 对 z 做了卑鄙的事情，那么 x 将有更高的愿望与 y 发起约会关系”。通过在规则的左侧使用谓词演算表达式，但在右侧将它们添加到总和的权重中，规则共同计算一个复杂的效用表面，结合了基于数字和逻辑的决策的优点。



响应者影响规则与发起者影响规则类似，不同之处在于它们用于评估响应者对她所参与的交流的感受。在一个与欲望形成非常相似的过程中，响应者确定他们对交流的感受。如果响应者的分数太低，响应者将拒绝交流，导致与社交交流意图不同（通常相反）的社会效果。除了特定于交流的响应者影响规则外，微观理论也用于计算响应者分数。对于《舞会周》，默认的接受 / 拒绝边界是 0；响应者分数高于 0 导致接受社交交流。响应者接受 / 拒绝边界是难度设置调整的参数之一。



最后，一个社交交流有一组实例，每个实例由效果和自然语言生成模板组成。实例分为接受和拒绝实例。每个实例是社交交流可能的不同表现方式。与实例相关联的是测试条件，以查看实例在当前上下文中是否有效。每个交流都有一个通用的接受和拒绝实例，对实例没有条件限制。更专门的实例有额外的条件，并以更专门的方式进行交流，此外还有更多的效果。例如，“分手” 社交交流的一个接受实例有条件 trait (cold,i)—— 这个实例不仅导致终止约会关系，还有额外的影响，如终止朋友关系。如果多个实例的条件评估为真，选择最显著的实例，显著性通过计算每个条件中真谓词的加权和来确定（与谓词类型相关联的权重表明该谓词对于确定社会背景的特异性有多重要）。



实例表现由使用自然语言生成模板表示的对话行组成，角色在交流期间说出这些对话行。在《舞会周》的情况下，对话行带有角色要执行的动画标签。例如，“回忆” 的一个接受实例有条件，即响应者最近做了某事使第三方尴尬，并且发起者与同一第三方是敌人。在这个实例中，发起者和响应者通过回忆响应者如何让这个不受欢迎的第三方尴尬而建立联系（增加友谊感情）。这个实例的模板对话是：



对话中的加粗元素展示了 CiF 支持的一些自然语言生成标签，包括 SFKB 引用和特定角色的贬义词。在西蒙和莫妮卡谈论奥斯瓦尔德的情况下，对话可能会变成：



CiF 架构的最后一个元素是触发规则。这些是在所有社交交流中共享的效果（和相关条件）。除了社交交流本身引起的社会状态变化外，触发规则还可能引起额外的变化。触发规则捕捉社交交流的级联后果以及跨越多个社交交流的状态变化。考虑以下示例触发规则：



这条规则说，如果 x 和 y 不是敌人，并且 x 有属于更一般 “善良” 特质类别的一个特质，并且第三方 z 在过去 7 个社交交流中对 y 做了属于更一般负面互动类别的某事，并且 x 自己在过去 7 个交流中没有对 y 做卑鄙的事情，那么 x 获得同情 y 的状态。或者，更简洁地说，善良的人会同情那些遭遇不幸的人，只要他们自己没有对同一个人做过卑鄙的事情。像所有触发规则一样，这条规则可以在任何社交交流之后触发。

## 43.4 交互方式



既然已经描述了架构，本节将介绍类似 CiF 架构可以集成到玩家交互循环中的不同方式。当前版本的 CiF 将社交交流视为离散的对话单元；因此，CiF 目前支持离散选择的社交互动模型。



《舞会周》采用了上帝视角游戏界面，玩家不扮演特定角色，而是告诉角色该做什么。当玩家选择两个角色时，CiF 计算第一个角色与第二个角色发起每个社交游戏的意愿。然后系统在菜单中显示意愿最高的行动，并进行一些混合以确保菜单中出现多种意图。角色只是偶尔采取自主行动。当一个角色产生极高的发起社交交流的意愿时，玩家会被告知该行动将在几步之内发生。这是为《舞会周》添加的一个额外挑战元素。例如，玩家可能试图实现让一个角色同时与三个其他角色约会的故事目标。但通常情况下，当玩家成功让该角色发起第二段约会关系时，其第一个恋爱对象往往会产生强烈意愿去发起一场社交交流以终止他们之间的关系。这种自主发起的交流给玩家实现目标的回合数设置了严格限制。



在《米斯庄园》（Mismanor）这款使用 CiF 构建的实验性角色扮演游戏中 [Sullivan 等人 10; Sullivan 12]，CiF 得到了扩展，纳入了信息和物品的元素。这个版本的 CiF，被称为 CiF - RPG，支持角色产生获取和分享信息、获取、失去和使用物品的意愿，以及网络和关系方面的意图。在 CiF 模型的支持下，任务通常具有社交性、非预设性的解决方案。在《米斯庄园》中，玩家扮演一个特定的玩家角色。玩家角色的建模方式与其他 CiF 角色相同，拥有一系列特质、状态等等。特质在角色创建过程中被分配。当玩家与非玩家角色互动时，呈现的菜单选项由玩家角色想要与该非玩家角色进行的意愿最高的社交交流决定。从某种意义上说，CiF 在支持角色扮演方面发挥了积极、动态的作用。非玩家角色也有机会与玩家和彼此进行自主行动。



CiF 的另一种用途是作为一种模拟，在玩家周围创造丰富的社交背景。例如，在一款角色扮演游戏中，村庄里的角色可以通过 CiF 驱动的社交交流过着他们的日常生活并相互交往。这些社交交流可以用来动态地揭示背景故事，并频繁提及玩家角色的行为。在这种更自主的模式下，可以使用许多知名的效用选择方法（例如，基于意愿的加权随机选择、在前 n 个中随机选择等）来进行行动选择。



目前，我们正在努力扩展 CiF，以支持即时互动，摆脱目前原子化的社交交流形式。在这种互动模式下，玩家控制一个实时角色，使用单个手势和有限的自然语言进行互动。为了实现这一点，实例被表示为 ABL 行为的集合 [Mateas 和 Stern 02]，并自下而上地识别玩家发起的意图。

## 43.5 相关工作



在这里，我们简要介绍最相关的相关工作。《模拟人生 3》采用了与 CiF 类似的社交模型。其角色具有特质和欲望，这些特质和欲望影响他们所执行的社交行为（社会规范和期望集群）[Evans 08]。一个模拟市民可以同时参与多个行为，一个行为也可以同时涉及多个模拟市民。因此，《模拟人生 3》的人工智能将社交行为表示为非原子化的、可以相互混合的交互，这与 CiF 的原子化交互不同。然而，模拟市民进行的是更抽象的交互，并且不使用具体的对话。此外，角色没有背景故事，在决策中也没有复杂地利用历史。最后，CiF 支持对直接社交交流之外的第三方的引用，支持更复杂的社会决策和级联社会效应。



最近，Evans 开发了 ，一种道义逻辑，它 “区分实际情况和应该的情况”[Evans 11]。例如，一个 规则可以捕捉这样的推理：“如果 x 的肚子是空的并且 y 是食物，那么 x 应该吃 y”。虽然 CiF 依靠规则右侧的权重 / 意图对来确定角色的欲望，但 的规则推断角色应该做什么以及角色认为其他角色应该做什么。 是一种道义认知逻辑（它可以表示实际情况、应该的情况、已被传达的内容和意图传达的内容）[Evans 09]，已在 中实现。这是对 Evans 对自己早期工作的批评的回应，在早期工作中，社交行为被表示为角色毫无问题地知道如何参与的活动，而不是角色积极努力相互帮助维持活动状态的活动（人类活动的民族方法学方法）。同样的批评也适用于 CiF。



Evans 和 Short 开发了 Praxis，一个与 CiF 有许多相似之处的系统，它是商业发布的游戏 Versu 的背后支撑 [Evans 和 Short 12; Evans 和 Short 13]。在 Praxis 中，社交行为被表示为提供角色行动的社会便利性的状态集合。与 CiF 的原子化社交交流不同，行为涉及多个状态变化，玩家有选择的机会。这也支持多种行为的混合。角色特质以及角色对彼此的判断影响这些行为的表现。

## 43.6 结论



CiF 架构使一群角色能够进行丰富的社交互动，说出通常与手工编写的对话树相关联的具体对话，同时利用通常与模拟游戏相关联的一定程度的涌现式社交模拟。



为了实现这一点，多角色社交交流与任何特定角色分开明确表示。给定一组具有特质和社会状态声明表示的角色，社交交流针对特定角色重新定位。因此，社交交流为推理社交交流提供了一个抽象层，并为概括可重用对话提供了一种机制。



角色基于软决策（不是布尔标志或严格的前提条件）决定他们想做什么以及与谁一起做，软决策可以考虑数百个因素。这使得整个角色群体的复杂关系状态和历史能够影响个体决策。



社交互动不仅会导致社会状态的单一变化，还会在多个角色中产生级联后果。这些级联效应有助于营造一个充满生机的世界的感觉，角色沉浸在不断变化的社会背景中。



先前社交互动的表现细节和结果存储在情景记忆中，并在社交交流表现期间（社交交流对话可以参考过去的表现）以及帮助确定角色想要参与哪些社交交流时使用。这提供了一种通常在非玩家角色中缺失的强烈的历史依赖感。



这些特性共同为模拟一个社会世界奠定了基础，在这个世界中，角色沉浸在不断演变的社会状态海洋中。