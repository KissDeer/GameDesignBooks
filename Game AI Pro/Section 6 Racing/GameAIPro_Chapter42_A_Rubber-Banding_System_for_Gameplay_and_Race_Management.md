# 六杠五、用于游戏玩法和比赛管理的橡皮筋系统



作者：Nic Melder

## 42.1 引言



橡皮筋效应是赛车游戏中用于使人工智能车手保持在玩家附近，以维持比赛的紧张刺激感的一种技术。简单来说，当一辆人工智能控制的车辆在玩家前面太远时，它会减速让玩家追上；同样，在玩家后面的人工智能车辆会获得速度提升以追上玩家。通过这种方式，人工智能车辆就好像通过一根橡皮筋与玩家相连，永远不会离玩家太远，因此被称为橡皮筋效应。



如果处理得当，这种效果对玩家来说可能难以察觉，同时能保持比赛的紧张和刺激感。然而，如果处理不当，玩家可能会感觉被欺骗，特别是当与他们驾驶相同车辆的人工智能明显速度更快时。本文介绍了实现橡皮筋效应的方法，讨论了可能遇到的一些特殊情况，并解释了如何将其扩展为一个适用于长距离比赛的全面的比赛节奏系统。

## 42.2 橡皮筋效应的实现



为了实现橡皮筋效应，我们要降低玩家前面车辆的速度，并加快玩家后面车辆的速度；车辆离玩家越远，我们对其加速或减速的幅度就越大。图 42.1 展示了我们想要实现的典型图表。



在区域 c 内，橡皮筋效应被禁用。在实践中，这意味着玩家周围的任何车辆都会正常行驶，所以当玩家处于激烈竞争中时，他不会看到自己的车辆和人工智能车辆之间有任何明显的差异。区域 d 显示对车辆有线性负向影响，导致它们在玩家前面越远就越慢，直到区域 e，此时负向影响的水平保持不变。这被称为正向橡皮筋效应。同样，区域 b 显示对车辆有线性正向影响，使它们加速，直到到达区域 a。这被称为反向橡皮筋效应。需要注意的是，线性关系不是唯一的选择；使用 S 型或其他函数也可以。

## 42.3 基于动力和基于难度的橡皮筋效应



有两种主要方法可以用来加速或减速人工智能车辆。方法一是修改车辆的动力。玩家前面的车辆动力会降低，从而减少加速度和最高速度。同样，玩家后面的车辆会获得动力，因此会有更好的加速度，可能还有更高的最高速度。



方法二是修改车手的技能水平。为了使玩家前面的车辆减速，降低他们的车手技能。根据难度的实现方式，这可能会导致人工智能比正常情况更早刹车，在弯道减速更多，出弯道时加速不那么有力。这种较低车手技能的总体效果是人工智能车辆会变慢；相反，提高车手技能将有助于追上。



在实践中，最好的方法是结合使用这两种方法，因为它们各有优缺点。通常，通过修改车手技能来加速或减速车辆更好，因为车手仍然驾驶相同的车辆，所以不会有 “作弊” 的感觉。然而，当车手技能已经达到最大值时，增加车辆速度的唯一方法是给车辆增加额外动力。在低端情况类似，当车手技能已经处于最小值时，进一步减速只能通过降低车辆动力来实现。图 42.2 展示了如何结合这两种方法以达到最大效果。

## 42.4 基于动力的橡皮筋效应问题



根据底层物理模拟的深度，基于动力的应用可能会导致一些问题。这些问题的严重程度在很大程度上取决于动力变化的大小，包括：



1. 由于额外动力超过了可用的轮胎抓地力，人工智能无法控制车辆，特别是在出弯道时车辆会打滑。
   可以通过设置车辆始终以额外动力行驶来解决这个问题。或者，可以增加抓地力，使其更难失去牵引力。
2. 动力不足的车辆无法爬坡或换挡。
3. 如果音频直接由车辆物理控制，会出现音频问题。有了额外动力，车辆会加速更快，听起来可能不正常。同样，车辆在最高档位时更有可能达到极限，导致音频不断播放极限效果。

## 42.5 禁用橡皮筋效应



在一些情况下，你不希望对车辆应用动力修改器。如果存在以下任何一种情况，应禁用所有橡皮筋效应：



1. 比赛开始。赛车人工智能的一个最大问题区域是进入第一个弯道，在那里多辆车需要同时减速并通过弯道。理想情况下，你希望车辆在到达第一个弯道时分散开并排成一列，以避免拥堵、碰撞和堵塞。显然，正向橡皮筋效应会使它们更聚集在一起，这与我们想要的结果相反。实际上，给玩家前面的车辆额外动力以帮助它们分散开是可取的（即对前面的车辆应用反向橡皮筋效应）。
2. 低速。如果一辆车在玩家前面很远，并且其动力已经降低，它将无法有效加速。从静止启动（例如，在碰撞后），车辆可能实际上没有足够的动力来启动。
3. 被套圈。在赛道上，人工智能有可能套圈玩家。在这种情况下，人工智能在玩家前面很远（就赛道距离而言），将以最大的负向橡皮筋效应行驶（即处于最低车手技能和最低动力）。这会导致车辆在赛道上以非常没有竞争力的方式缓慢行驶。在这种情况下，最好禁用该车辆的橡皮筋效应，这样玩家就不会明显察觉到橡皮筋效应的存在。

## 42.6 分屏多人模式中的橡皮筋效应



如果赛道上有不止一辆人类驾驶的车辆，不清楚应该以哪辆车作为橡皮筋效应的参考。一个好的解决方案是将最后面的玩家车辆作为反向橡皮筋效应的参考，将最前面的玩家车辆作为正向橡皮筋效应的参考，而玩家车辆之间的任何人工智能车辆则不应用橡皮筋效应。

## 42.7 改进的橡皮筋效应以减少聚集



正向橡皮筋效应的一个副作用是，特别是在短距离内使用较大的车手技能 / 动力变化时，人工智能车辆可能会聚集在一起。如果玩家快速追上它们，即使它们受到的橡皮筋效应最小，它们仍然会聚集在一起。这是不理想的，因为这可能使玩家一次超越许多车辆。作为玩家，赛车游戏的乐趣之一是与人工智能竞争以获得位置；能够一次超越许多对手会损害玩家的体验。两种防止聚集的方法是：



1. 使用最前面车辆的距离作为最大距离。如前所述，任何超过最大距离的车辆都将应用最大的橡皮筋效应。相反，通过使用最大定义距离或离玩家最远车辆的距离中的较大值，橡皮筋效应可以在更大的距离上实现。这并不能消除聚集，但由于效应的作用距离更大，会减缓聚集的速度。
2. 平均位置。通过计算玩家前面超过阈值距离的所有车辆的平均位置，然后以相同的程度影响所有这些车辆（基于它们的平均位置），整个车群将同时减速。因为多个车辆同时以相同的方式受到影响，它们在受到橡皮筋效应影响时保持相同的间距。

## 42.8 选择参数



在设置橡皮筋效应系统时，选择合理的参数非常重要，因为这会对游戏难度和玩家对人工智能的看法产生很大影响。一般来说，你要确保在靠近玩家时不应用橡皮筋效应，否则动力优势会变得明显。因此，选择区域 c 中的死区宽度至关重要，这样人工智能就没有不适当的、明显的优势，但同时人工智能仍然能够在玩家的后视镜范围内追上。



橡皮筋效应系统也可以用作难度平衡的一部分。通过为正向橡皮筋效应设置负的最小距离，玩家将更容易超越人工智能，因为当并排时，人工智能的动力总是比玩家少。同样，通过调整橡皮筋效应作用的最大距离，人工智能会分布得更开，与较小的最大距离相比，减少了超车机会。

## 42.9 特殊情况 —— 第一名的橡皮筋效应



当赛道上只有一辆车时，总是会产生最快的时间，因为可以在不需要超越其他车辆的情况下驾驶完美的赛车线。基本上，第一名的车辆就是这种情况，所以通常第一名车辆和其他车群之间会形成很大的差距。可以通过对第一名车辆应用额外的橡皮筋效应来缩小这个差距。这与前面描述的方法相同，但使用的距离是第一名和第二名之间的距离，而不是人工智能和玩家之间的距离。

## 42.10 橡皮筋效应和长距离比赛 —— 比赛节奏系统



橡皮筋效应系统的目的是减慢或加快玩家周围的人工智能车辆的速度。本质上，它根据一些预定标准使人工智能更快或更慢。通过添加这些标准，我们可以将橡皮筋效应的实现扩展为一个可以在长距离比赛中调整比赛节奏的系统。在一场 50 圈的比赛中，车手通常会在前 10 圈努力比赛，然后在接下来的 30 圈放松（减速），最后 10 圈再努力比赛。如果涉及进站，那么人工智能可能需要在进站前一圈和进站后一圈努力比赛，然后再回到放松的驾驶状态。这些额外的规则可以添加到前面描述的系统中，以创建一个更丰富的人工智能管理工具，用于控制整个比赛的节奏。关于实现比赛节奏系统的更多想法可以在其他地方找到 [Jimenez 09]。

## 42.11 结论



本文描述了一个通过改变车手技能和车辆动力来使人工智能竞争对手保持在玩家周围的橡皮筋效应系统。仅通过操纵车手技能可以使人工智能在玩家周围而不显得作弊。然而，在人工智能速度过快或过慢的情况下，可以使用基于动力的橡皮筋效应。本文还描述了这种方法的问题（特别是失控和明显作弊）以及如何避免这些问题。还展示了对基本橡皮筋效应系统的改进（避免聚集、第一名领先、与多个玩家合作）以及如何将该系统进一步扩展为一个功能齐全的比赛节奏系统。